
<% layout("/layouts/boilerPlate") %>
<%= success %>
<link
  href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
  rel="stylesheet"
/>

<style>

 .form-control:focus {
    box-shadow: none;
    border-color: #6366f1;
  }

  .btn-primary {
    background-color: #4f46e5;
    border: none;
  }

  .btn-primary:hover {
    background-color: #4338ca;
  }

  .password-toggle {
    position: absolute;
    top: 50%;
    right: 15px;
    transform: translateY(-50%);
    cursor: pointer;
    font-size: 1.1rem;
    opacity: 0.7;
  }

  .password-toggle:hover {
    opacity: 1;
  }
  /* login eye css */


.password-toggle1 {
  background: transparent;
  border: none;
  cursor: pointer;
}



.password-toggle1 {
  border-left: 0;
}

.form-control:focus {
  z-index: 1;
}

.password-toggle1 {
  z-index: 3;
}


/* ///////////// */
/* Close shop bar */
.close-shop-bar {
  width: 20%;
  background-color: #4f46e5;
  color: #fff;
  padding: 8px 0;
  border-radius: 6px;
 font-weight: 600;
min-width: 120px;
  text-decoration: none;
  transition: background 0.2s ease;
}
.close-shop-bar:hover {
  background: #2842d6;
  color: #fff;
   opacity: 1;
}

/* Live orders card */
.live-orders-card {
  background: #f4f7ff;
  border-radius: 14px;
  padding: 28px 20px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.06);
}

.live-orders-card .icon {
  font-size: 32px;
  margin-bottom: 8px;
}

.live-orders-card .title {
  font-weight: 700;
  margin-bottom: 6px;
}

.live-orders-card .subtitle {
  color: #6b7280;
  font-size: 14px;
  margin: 0;
}

/* Mobile responsiveness */
@media (max-width: 676px) {
  .live-orders-card {
    padding: 22px 16px;
  }
  .live-orders-card .title {
    font-size: 18px;
  }
  .close-shop-bar{

     font-size: 13px;
     min-width: 100px;
     padding: 10px 0;
  }
}











</style>


<!-- <h1>Restaurant Dashboard (RepairNow)</h1>

<label>Restaurant ID: <input id="restId" /></label>
<button id="join">Connect</button>

<div id="orders"></div>  -->

 <!-- Load your JS logic -->
 <!-- <script src="/socket.io/socket.io.js"></script>
 <script src="https://www.gstatic.com/firebasejs/9.9.4/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.9.4/firebase-messaging.js"></script>
<script src="/js/firebase-config.js"></script>
<script src="/js/mobileShops.js"></script>  -->


<!-- <h1 style="text-align: center;">Mobileshop Dashboard (RepairNow)</h1> -->
 <!-- <div class="dashboard-header">
  <h1>
    <span class="brand">RepairNow</span>
    <span class="title">Mobile Shop Dashboard</span>
  </h1>
  <p class="subtitle">Manage orders, repairs, and live updates in one place</p>
</div>


<h3>Register (first time)</h3> -->
<!-- <form id="restaurantForm">
  <input  type="text"  id="name" name="name" placeholder="Restaurant Name" required />
  <input  type="text"  id="address" name="address"     placeholder="Address" required />
  <input type="number"  id="mobile"  name="mobile"    placeholder="Mobile" required />
  <button type="submit">Register & Save Token</button>
</form> -->

<!-- <form id="restaurantForm">
  <input type="text" id="name" name="name" placeholder="Username" required />
  <input type="email" id="email" name="email"  placeholder="Email" required />
  <input type="password" id="password" name="password"  placeholder="Password" required />
  <input type="number" id="phone"  name="phone" placeholder="Phone" required />
  <input type="text" id="address" name="address"  placeholder="Address" required />
  <button type="submit">Sign Up</button>
</form> -->
  <!-- Dashboard Header -->
<!-- Dashboard Header -->

<!-- Register Section -->



<!-- <label>Restaurant ID: <input id="restId" /></label> -->

<!-- ----------------------------------------------------------------------- -->
 <!-- <label>Restaurant ID: <input id="restId" /></label>
<button id="join">Connect</button> -->


  <% if(!currentRestaurant) { %>
<!-- 
     <div class="page-container">
  <div class="register-container">
    <h3>Register <span>(first time)</span></h3>

    <form id="restaurantForm">
      <input type="text" id="name" name="name" placeholder="Shop Name" required />
      <input type="email" id="email" name="email" placeholder="Email Address" required />
      <input type="number" id="phone" name="phone" placeholder="Phone Number" required />
      <input type="password" id="password" name="password" placeholder="Password" required />
      <input type="text" id="address" name="address" placeholder="Shop Address" required />

      <button type="submit">Create Account</button>
    </form>
  </div>

  <hr class="section-divider" />
</div> -->
<!-- ////////////////////////// -->
<div class="container min-vh-100 d-flex align-items-center justify-content-center">
  <div class="row w-100 justify-content-center">
    <div class="col-md-8 col-lg-6">

     

             <div class="card-header text-center rounded-top-4" style="background: linear-gradient(135deg, #4f46e5, #6366f1);">
          <h4 class="mb-1 fw-bold" style="color:#ffffff; text-shadow:0 2px 6px rgba(0,0,0,0.4);">
            Register
          </h4>
          <p class="mb-0" style="color: rgba(255,255,255,0.85); font-size:0.9rem;">Manage orders, repairs, and live updates in one place</p>
        </div>

      <!-- Register Card -->
      <div class="card shadow-lg border-0 rounded-4">
        <div class="card-body p-4">
          <h3 class="text-center mb-4">
            Register <span class="text-muted" style="font-size:0.9rem;">(first time)</span>
          </h3>

          <form id="restaurantForm" novalidate>
     <label class="form-label">Shop Name :</label>
            <div class="mb-3">
              <input type="text" id="name" name="name" class="form-control" placeholder="Shop Name" required />
            </div>
        <label class="form-label">Email Address :</label>
            <div class="mb-3">
              <input type="email" id="email" name="email" class="form-control" placeholder="Email Address" required />
              <div class="invalid-feedback">Please enter a valid email</div>
            </div>

            <div class="mb-3">
               <label class="form-label">Phone :</label>
              <input type="number" id="phone" name="phone" class="form-control" placeholder="Phone Number" required />
              <div class="invalid-feedback">Please enter a valid number</div>
            </div>

            <!-- Password with eye toggle -->
               <label class="form-label">Password :</label>
         
            <div class="mb-3 position-relative">
  <input
    type="password"
    id="password"
    name="password"
    class="form-control"
    placeholder="Password"
    required
  />

  <span class="password-toggle" onclick="togglePassword()">
    <i class="bi bi-eye-slash" id="toggleIcon"></i>
  </span>
</div>
     <label class="form-label">Shop Address :</label>
            <div class="mb-3">
              <input type="text" id="address" name="address" class="form-control" placeholder="Running Address" required />
              <div class="invalid-feedback">Please enter a running shop address</div>
            </div>

           

            <div class="d-grid">
              <button type="submit" class="btn btn-primary btn-lg d-flex align-items-center justify-content-center" id="registerBtn">
                <span class="spinner-border spinner-border-sm me-2 d-none" id="registerSpinner"></span>
                <span id="registerText">Create Account</span>
              </button>
            </div>

          </form>
        </div>
      </div>

    </div>
  </div>
</div>

<hr>

<div class="container d-flex align-items-center justify-content-center min-vh-100">
  <div class="row w-100 justify-content-center">
    <div class="col-md-6 col-lg-4">
      <div class="card shadow-lg border-0 rounded-4">
        <div class="card-header text-center rounded-top-4" style="background: linear-gradient(135deg, #4f46e5, #6366f1);">
          <h4 class="mb-1 fw-bold" style="color:#ffffff; text-shadow:0 2px 6px rgba(0,0,0,0.4);">
            Live Orders Login
          </h4>
          <p class="mb-0" style="color: rgba(255,255,255,0.85); font-size:0.9rem;">Mobile Shop Dashboard</p>
        </div>


        <div class="card-body p-4">
          <form id="loginForm" action="/mobileShop/login_Shop" method="POST" novalidate class="needs-validation">

            <!-- Email -->
             <label class="form-label">Email</label>
            <div class="mb-3">
              <div class="input-group">
                <span class="input-group-text"><i class="bi bi-envelope"></i></span>
                <input type="email" name="email" class="form-control" placeholder="shop@email.com" required>
                <div class="invalid-feedback">Please enter a valid email</div>
              </div>
            </div>

            <!-- Password -->
            <!-- <div class="mb-3">
             
              <div class="input-group">
                <span class="input-group-text"><i class="bi bi-lock"></i>Password</span>
                <input type="password" id="pass" name="password" class="form-control" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                 <span class="password-toggle" onclick="togglePassword1()">üëÅÔ∏è</span>
                <div class="invalid-feedback">Password is required</div>
              </div>
            </div> -->
            <div class="mb-3">
  <!-- <label class="form-label">Password</label>

  <div class="input-group">
    <span class="input-group-text">
      <i class="bi bi-lock"></i>
    </span>

    <input
      type="password"
      id="pass"
      name="password"
      class="form-control"
      placeholder="password"
      required
    />

    
    <button
      type="button"
      class="input-group-text password-toggle"
      onclick="togglePassword1()"
    >
      <i class="bi bi-eye"></i>
    </button>
  </div>

  <div class="invalid-feedback">Password is required</div> -->
  <!-- <label class="form-label">Password</label>

<div class="input-group">
  <span class="input-group-text">
    <i class="bi bi-lock"></i>
  </span>

  <input
    type="password"
    id="pass"
    name="password"
    class="form-control"
    placeholder="password"
    required
  />

  
  <button
    type="button"
    class="input-group-text password-toggle"
    onclick="togglePassword1()"
  >
    <i class="bi bi-eye" id="eyeIcon"></i>
  </button>
</div>

<div class="invalid-feedback">Password is required</div> -->
<label class="form-label">Password</label>
<div class="input-group">
  <span class="input-group-text">
    <i class="bi bi-lock"></i>
  </span>

  <input
    type="password"
    id="pass"
    name="password"
    class="form-control"
    placeholder="password"
    required
  />

  <button
    type="button"
    class="btn btn-outline-secondary password-toggle1"
    onclick="togglePassword1()"
  >
    <i class="bi bi-eye-slash" id="eyeIcon"></i>
  </button>
</div>


</div>




            <!-- Remember Me -->
            <div class="d-flex justify-content-between align-items-center mb-3">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="rememberMe">
                <label class="form-check-label" for="rememberMe">Remember me</label>
              </div>
              <a href="#" class="text-decoration-none" style="font-size: 0.85rem;">Forgot password?</a>
            </div>

            <!-- Submit Button -->
            <div class="d-grid">
              <button type="submit" class="btn btn-primary btn-lg rounded-3 d-flex align-items-center justify-content-center" id="loginBtn">
                <span class="spinner-border spinner-border-sm me-2 d-none" id="loginSpinner" role="status" aria-hidden="true"></span>
                <span id="loginText">Login</span>
              </button>
            </div>
          </form>
        </div>

        <div class="card-footer text-center bg-light rounded-bottom-4">
          <small class="text-muted">¬© 2026 Mobile Repair Services</small>
        </div>
      </div>
    </div>
  </div>
</div>


 
<% } %>






<% if (currentRestaurant) { %>
  <!-- <div class="shopClose">
  <a href="/mobileShop/yourShop/logout" class="close-shop-btn">
    üö´ Close Your Shop
  </a>
</div>
 <div class="live-orders-header">
  <h3>‚ö° Connect to Live Orders</h3>
  <p class="subtitle">Receive real-time notifications from your customers</p>
</div> -->
<!-- CLOSE SHOP BAR -->
<div class="container my-3">
  <a href="/mobileShop/yourShop/logout"
     class=" btn btn-danger  btn-md" style="
text-align: center;">
    ‚õî Close Shop
  </a>
</div>

<!-- LIVE ORDERS CARD -->
<div class="container mb-5">
  <div class="live-orders-card text-center">
    <div class="icon">‚ö°</div>
    <h4 class="title">Connect to Live Orders</h4>
    <p class="subtitle">Receive real-time notifications from your customers</p>
  </div>
</div>





  
<div id="orders"></div>
  <script>
    const RESTAURANT_ID = "<%= currentRestaurant._id %>";
  </script>
<% } %>

<!-- Socket.IO client (served by your server) -->
<script src="/socket.io/socket.io.js"></script>

<!-- Firebase v8 (compat) CDN - MUST be before firebase-config.js -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-messaging.js"></script>
<script>
  const form1 = document.getElementById('loginForm');
  const spinner1 = document.getElementById('loginSpinner');
  const text1 = document.getElementById('loginText');
  const btn1 = document.getElementById('loginBtn');

  form1.addEventListener('submit', (e) => {
    // If form is invalid, stop spinner
    if (!form1.checkValidity()) {
      e.preventDefault();
      e.stopPropagation();
      form1.classList.add('was-validated');
      return;
    }

    // Form is valid ‚Üí show spinner
    spinner1.classList.remove('d-none');
    text1.textContent = 'Processing...';
    btn1.disabled = true;
  });

  
</script>





 <!-- login eye  -->
  <!-- <script>
function togglePassword1() {
  const password = document.getElementById('pass');
  const icon = document.querySelector('.password-toggle i');

  if (password.type === 'password') {
    password.type = 'text';
    icon.classList.replace('bi-eye', 'bi-eye-slash');
  } else {
    password.type = 'password';
    icon.classList.replace('bi-eye-slash', 'bi-eye');
  }
}
</script> -->


<script>
  function togglePassword() {
    const password = document.getElementById('password');
    password.type = password.type === 'password' ? 'text' : 'password';
  }

  const form = document.getElementById('restaurantForm');
  const spinner = document.getElementById('registerSpinner');
  const text = document.getElementById('registerText');
  const btn = document.getElementById('registerBtn');

  form.addEventListener('submit', async (event) => {
    // if (!form.checkValidity()) return;
    if (!form.checkValidity()) {
      event.preventDefault(); // STOP submit
      event.stopPropagation(); 
      return;
    }
    spinner.classList.remove('d-none');
    text.textContent = 'Creating Account...';
    btn.disabled = true;
  });
</script>
<script>
function togglePassword() {
  const password = document.getElementById('password');
  const icon = document.getElementById('toggleIcon');

  if (password.type === 'password') {
    password.type = 'text';
    icon.classList.replace('bi-eye-slash', 'bi-eye');
  } else {
    password.type = 'password';
    icon.classList.replace('bi-eye', 'bi-eye-slash');
  }
}
</script>
<!-- login -->
<script>function togglePassword1() {
  const pass = document.getElementById("pass");
  const icon = document.getElementById("eyeIcon");

  if (pass.type === "password") {
    pass.type = "text";
     icon.classList.replace("bi-eye-slash", "bi-eye");
  } else {
    pass.type = "password";
  
     icon.classList.replace("bi-eye", "bi-eye-slash");
  }
}</script>


<script src="/js/firebase-config.js"></script>


<script src="/js/mobileShops.js"></script>
